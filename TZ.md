# Техническое Задание (ТЗ) на разработку сервиса аренды премиальных автомобилей

## 1. Общие сведения
**Цель проекта:** Создание современной, высокопроизводительной и масштабируемой платформы для аренды автомобилей премиум-класса "под ключ". Платформа должна обеспечивать полный цикл обслуживания клиента: от поиска автомобиля до оплаты и управления бронированием.

**Целевая аудитория:** Люди с высоким достатком, туристы, бизнес-клиенты.

## 2. Технологический стек
*   **Frontend:** Next.js 16 (App Router), React 19, Tailwind CSS 4, Framer Motion.
*   **Backend:** Next.js Server Actions / API Routes.
*   **База данных:** PostgreSQL (вместо текущей SQLite) для надежности и конкурентного доступа.
*   **ORM:** Prisma.
*   **Аутентификация:** NextAuth.js (Auth.js) v5.
*   **Хранилище файлов:** AWS S3 совместимое (Cloudflare R2 или AWS S3).
*   **Платежи:** Stripe (международные) или ЮKassa (РФ).
*   **Карты:** Google Maps API или Mapbox.
*   **Email/SMS:** Resend (Email), Twilio (SMS).

## 3. Роли пользователей
1.  **Гость (Неавторизованный):**
    *   Просмотр каталога и детальных страниц авто.
    *   Использование поиска и фильтров.
    *   Просмотр информационных страниц (О нас, Контакты, Условия).
2.  **Клиент (Авторизованный):**
    *   Все права Гостя.
    *   Бронирование автомобилей.
    *   Оплата и внесение депозита.
    *   Личный кабинет (история, активные брони, профиль, документы).
    *   Оставление отзывов (только после завершенной аренды).
    *   Добавление в избранное.
3.  **Менеджер:**
    *   Просмотр и обработка входящих заявок.
    *   Управление календарем занятости.
    *   Связь с клиентом.
    *   Изменение статусов бронирования.
4.  **Администратор:**
    *   Полный доступ ко всем функциям.
    *   Управление автопарком (CRUD).
    *   Управление пользователями и ролями.
    *   Аналитика и отчеты.
    *   Настройки системы.

## 4. Функциональные требования

### 4.1. Модуль "Аутентификация и Пользователи"
*   Регистрация/Вход через Email + Пароль.
*   Вход через социальные сети (Google, Apple).
*   Восстановление пароля через Email.
*   Подтверждение Email.
*   **Профиль пользователя:**
    *   Личные данные (ФИО, телефон, email).
    *   Загрузка документов (Водительское удостоверение, Паспорт) — с безопасным хранением.

### 4.2. Модуль "Каталог и Поиск"
*   **Фильтрация:** По датам (доступность), марке, типу кузова, цене, году выпуска.
*   **Сортировка:** По цене (возр/убыв), популярности, новизне.
*   **Карточка авто:** Фото, название, цена за сутки, краткие характеристики, лейблы (New, Sale).
*   **Детальная страница:**
    *   Галерея фото (слайдер) + Видео/360 обзор.
    *   Полные характеристики.
    *   Календарь доступности.
    *   Блок похожих автомобилей.
    *   Отзывы.

### 4.3. Модуль "Бронирование и Оплата"
*   **Калькулятор стоимости:**
    *   Расчет цены в зависимости от количества дней (скидки за длительность).
    *   Добавление дополнительных услуг (детское кресло, страховка, доставка).
*   **Проверка доступности:** Блокировка дат в реальном времени (исключение овербукинга).
*   **Оформление:**
    *   Ввод данных водителя (или автозаполнение из профиля).
    *   Выбор места получения и возврата (на карте или списком).
*   **Оплата:**
    *   Интеграция платежного шлюза.
    *   Холдирование депозита.
    *   Частичная или полная оплата.

### 4.4. Модуль "Админ-панель и CRM"
*   **Дашборд:** Ключевые метрики (Выручка, Активные брони, Загрузка автопарка).
*   **Календарь бронирований (Gantt):** Визуальная сетка занятости всех машин.
*   **Управление бронированиями:**
    *   Статусы: *Pending, Confirmed, Paid, Active, Completed, Cancelled, Refunded*.
    *   Редактирование деталей брони.
*   **Управление автопарком:**
    *   Добавление/Редактирование/Удаление/Скрытие.
    *   Управление ценами и сезонными коэффициентами.
    *   Учет технического состояния (статус "В ремонте").

### 4.5. Модуль "Уведомления"
*   **Email:** Подтверждение брони, чек об оплате, напоминание за 24 часа, просьба оставить отзыв.
*   **Telegram/SMS:** Краткие уведомления о статусе заказа.

## 5. Нефункциональные требования
*   **Производительность:** Google PageSpeed Insights > 90 (Green zone). Использование ISR и оптимизации изображений.
*   **SEO:** SSR (Server Side Rendering), микроразметка Schema.org, автогенерация Sitemap.xml, мета-теги.
*   **Безопасность:** Защита от SQL Injection (через Prisma), XSS, CSRF. Rate Limiting для API. Шифрование чувствительных данных.
*   **Адаптивность:** Полная поддержка мобильных устройств, планшетов и десктопов.

## 6. Этапы реализации (Roadmap)

### Этап 1: Фундамент и База данных (1-2 недели)
*   Настройка PostgreSQL.
*   Проектирование схемы БД (User, Car, Booking, Review, Payment).
*   Настройка NextAuth (Аутентификация).
*   Настройка S3 для хранения файлов.

### Этап 2: Клиентская часть и Каталог (2 недели)
*   Реализация поиска и фильтров.
*   Детальная страница авто с галереей.
*   Личный кабинет пользователя.

### Этап 3: Бронирование и Платежи (2-3 недели)
*   Логика проверки доступности дат.
*   Интеграция Stripe/Yookassa.
*   Создание заказов и транзакций.

### Этап 4: Админ-панель (2 недели)
*   Календарь занятости.
*   Управление заказами и автопарком.
*   Аналитика.

### Этап 5: Тестирование и Запуск (1 неделя)
*   E2E тестирование.
*   SEO оптимизация.
*   Деплой на продакшн.

---

## Что требуется от Заказчика (Вас)

Для начала работы и настройки интеграций мне потребуются следующие данные:

1.  **Доступы к сервисам (API Keys):**
    *   **База данных:** Строка подключения к PostgreSQL (если есть предпочтения по хостингу, например Supabase, Neon, или я могу настроить сам).
    *   **Платежная система:** API ключи (Public/Secret) от Stripe или ЮKassa (тестовые для начала).
    *   **Карты:** Google Maps API Key (для отображения карт и автокомплита адресов).
    *   **Облачное хранилище:** AWS S3 / Cloudflare R2 (Access Key ID, Secret Access Key, Bucket Name) — для хранения фото авто.
    *   **Почта:** SMTP доступы или API Key (Resend/SendGrid) для отправки писем.
    *   **Auth:** Google Cloud Console Client ID & Secret (для входа через Google).

2.  **Контент и Бизнес-логика:**
    *   Список автомобилей с характеристиками и базовыми ценами (Excel/Google Sheets).
    *   Фотографии автомобилей (высокое качество).
    *   Правила ценообразования (скидки от кол-ва дней, сезонные наценки).
    *   Тексты для страниц "О нас", "Условия аренды", "Контакты".
    *   Логотип и брендбук (цвета, шрифты), если есть пожелания по изменению текущего стиля.

3.  **Организационные вопросы:**
    *   Доступ к хостингу (Vercel / VPS), если планируется деплой.
    *   Доменное имя (если есть).
